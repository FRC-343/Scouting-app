<!DOCTYPE html>
<html>
<head>
  <title>FRC Scouting Data</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #111;
      color: white;
      text-align: center;
      margin: 0;
      padding: 20px;
    }

    h1 {
      margin-bottom: 10px;
    }

    .section {
      background: #1e1e1e;
      padding: 15px;
      margin: 15px auto;
      border-radius: 10px;
      width: 350px;
      box-shadow: 0 0 10px rgba(255,0,0,0.3);
    }

    .counter {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 10px 0;
    }

    .counter button {
      background-color: red;
      border: none;
      color: white;
      font-size: 20px;
      width: 40px;
      height: 40px;
      cursor: pointer;
      border-radius: 6px;
      margin: 0 10px;
    }

    .counter span {
      font-size: 20px;
      width: 40px;
      display: inline-block;
    }

    input[type="text"], select {
      padding: 8px;
      border-radius: 6px;
      border: none;
      margin: 5px;
      text-align: center;
      font-size: 16px;
    }

    .checkbox-group {
      margin: 10px 0;
    }

    .submit-btn {
      background-color: red;
      border: none;
      padding: 12px 25px;
      font-size: 16px;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 20px;
    }

    label {
      display: block;
      margin-top: 10px;
    }

  </style>
</head>

<body>

<h1>FRC Match Scouting</h1>

<!-- Robot Info -->
<div class="section">
  <label>Robot Number</label>
  <input type="text" id="robotNumber" placeholder="FRC 000" oninput="formatRobot(this)">

  <label>Match Number</label>
  <input type="text" id="matchNumber">
</div>

<!-- Auto Section -->
<div class="section">
  <h2>Auto</h2>

  <div class="counter">
    <button onclick="changeCount('autoSpeaker', -1)">-</button>
    <span id="autoSpeaker">0</span>
    <button onclick="changeCount('autoSpeaker', 1)">+</button>
  </div>
  <label>Speaker</label>

  <div class="counter">
    <button onclick="changeCount('autoAmp', -1)">-</button>
    <span id="autoAmp">0</span>
    <button onclick="changeCount('autoAmp', 1)">+</button>
  </div>
  <label>Amp</label>

  <div class="checkbox-group">
    <label>
      <input type="checkbox" id="autoClimber">
      Climber Box (Auto)
    </label>
  </div>
</div>

<!-- Teleop Section -->
<div class="section">
  <h2>Teleop</h2>

  <div class="counter">
    <button onclick="changeCount('teleSpeaker', -1)">-</button>
    <span id="teleSpeaker">0</span>
    <button onclick="changeCount('teleSpeaker', 1)">+</button>
  </div>
  <label>Speaker</label>

  <div class="counter">
    <button onclick="changeCount('teleAmp', -1)">-</button>
    <span id="teleAmp">0</span>
    <button onclick="changeCount('teleAmp', 1)">+</button>
  </div>
  <label>Amp</label>
</div>

<!-- Endgame Section -->
<div class="section">
  <h2>Endgame</h2>

  <div class="checkbox-group">
    <label>
      <input type="checkbox" id="endClimbed">
      Climbed
    </label>

    <label>
      <input type="checkbox" id="endTrapped">
      Trapped
    </label>

    <label>
      <input type="checkbox" id="endClimber">
      Climber Box (Endgame)
    </label>
  </div>
</div>

<button class="submit-btn" onclick="submitData()">Submit</button>

<script>

function formatRobot(input) {
  let value = input.value.toUpperCase().replace(/[^0-9]/g, '');
  if (value.length > 0) {
    input.value = "FRC " + value;
  }
}

function changeCount(id, amount) {
  let element = document.getElementById(id);
  let value = parseInt(element.innerText);
  value += amount;
  if (value < 0) value = 0;
  element.innerText = value;
}

function resetForm() {
  document.getElementById("robotNumber").value = "";
  document.getElementById("matchNumber").value = "";

  document.getElementById("autoSpeaker").innerText = 0;
  document.getElementById("autoAmp").innerText = 0;
  document.getElementById("teleSpeaker").innerText = 0;
  document.getElementById("teleAmp").innerText = 0;

  document.getElementById("autoClimber").checked = false;
  document.getElementById("endClimbed").checked = false;
  document.getElementById("endTrapped").checked = false;
  document.getElementById("endClimber").checked = false;
}

function submitData() {

  const scriptURL = localStorage.getItem("webAppURL");

  if (!scriptURL) {
    alert("Web App URL not set. Please go back to index page.");
    return;
  }

  const data = {
    robotNumber: document.getElementById("robotNumber").value,
    matchNumber: document.getElementById("matchNumber").value,
    autoSpeaker: document.getElementById("autoSpeaker").innerText,
    autoAmp: document.getElementById("autoAmp").innerText,
    autoClimber: document.getElementById("autoClimber").checked,
    teleSpeaker: document.getElementById("teleSpeaker").innerText,
    teleAmp: document.getElementById("teleAmp").innerText,
    endClimbed: document.getElementById("endClimbed").checked,
    endTrapped: document.getElementById("endTrapped").checked,
    endClimber: document.getElementById("endClimber").checked
  };

  fetch(scriptURL, {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(() => {
    alert("Submitted Successfully!");
    resetForm(); // Auto reset after submit
  })
  .catch(error => {
    alert("Error submitting data.");
    console.error(error);
  });
}

</script>

</body>
</html>
